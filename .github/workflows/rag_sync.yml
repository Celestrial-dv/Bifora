name: RAG Knowledge Base Sync (Auto Resync)

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# ðŸ“Œ ìµœì í™” ì„¤ì • ìš”ì•½
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# âœ… ë°°ì¹˜ í¬ê¸°: 100ê±´ (Supabase timeout ë°©ì§€)
# âœ… ì›Œì»¤ ìˆ˜: 2ê°œ (API rate limit ì¤€ìˆ˜)
# âœ… íƒ€ìž„ì•„ì›ƒ: 180ë¶„ (ì¶©ë¶„í•œ ì²˜ë¦¬ ì‹œê°„)
# âœ… ëŒ€ê¸° ì‹œê°„: 3ì´ˆ (API ë¶€í•˜ ë¶„ì‚°)
# âœ… ì¦ë¶„ ë™ê¸°í™”: skip-synced=1 (ì¤‘ë³µ ë°©ì§€)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

on:
  schedule:
    # ë§¤ì¼ ì˜¤í›„ 11ì‹œ 55ë¶„(í•œêµ­ì‹œê°„) ì‹¤í–‰
    # í•œêµ­ì‹œê°„(KST) = UTC + 9ì‹œê°„
    # 23:55 KST = 14:55 UTC
    - cron: '55 14 * * *'
  
  # ìˆ˜ë™ ì‹¤í–‰ ì˜µì…˜
  workflow_dispatch:
    inputs:
      batch_size:
        description: 'ë°°ì¹˜ í¬ê¸° (ê¸°ë³¸ê°’: 50)'
        required: false
        default: '50'
      workers:
        description: 'ì›Œì»¤ ìˆ˜ (ê¸°ë³¸ê°’: 2)'
        required: false
        default: '2'
      max_iterations:
        description: 'ì›Œì»¤ë‹¹ ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜ (ê¸°ë³¸ê°’: 500)'
        required: false
        default: '500'
      # ðŸ†• ì²« ì‹¤í–‰ ì—¬ë¶€ ì˜µì…˜ ì¶”ê°€
      first_run:
        description: 'ì²« ì‹¤í–‰ ì—¬ë¶€ (ê¸°ë³¸ê°’: false)'
        required: false
        default: 'false'

env:
  CAFE24_SYNC_URL: ${{ secrets.CAFE24_SYNC_URL }}
  SYNC_TOKEN: ${{ secrets.SYNC_TOKEN }}

jobs:
  preflight:
    name: ðŸ” ì‚¬ì „ ì§„ë‹¨
    runs-on: ubuntu-latest
    outputs:
      can_proceed: ${{ steps.check.outputs.can_proceed }}
      mysql_total: ${{ steps.stats.outputs.mysql_total }}
      supabase_synced: ${{ steps.stats.outputs.supabase_synced }}
      remaining: ${{ steps.stats.outputs.remaining }}
      is_first_run: ${{ steps.stats.outputs.is_first_run }}
      
    steps:
      - name: ðŸ” í† í° ê²€ì¦
        id: check
        run: |
          if [ -z "${{ env.SYNC_TOKEN }}" ]; then
            echo "âŒ SYNC_TOKENì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."
            echo "can_proceed=false" >> $GITHUB_OUTPUT
            exit 1
          fi
          
          BASE_URL="${{ env.CAFE24_SYNC_URL }}"
          
          if [[ "$BASE_URL" == *"?"* ]]; then
            DIAG_URL="${BASE_URL}&t=${{ env.SYNC_TOKEN }}&diag=1"
          else
            DIAG_URL="${BASE_URL}?t=${{ env.SYNC_TOKEN }}&diag=1"
          fi
          
          RESPONSE=$(curl -s -w "\n%{http_code}" "$DIAG_URL")
          HTTP_CODE=$(echo "$RESPONSE" | tail -n1)
          BODY=$(echo "$RESPONSE" | sed '$d')
          
          if [ "$HTTP_CODE" != "200" ]; then
            echo "âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨: HTTP $HTTP_CODE"
            echo "$BODY"
            echo "can_proceed=false" >> $GITHUB_OUTPUT
            exit 1
          fi
          
          echo "âœ… í† í° ê²€ì¦ ì„±ê³µ"
          echo "$BODY" | jq '.'
          echo "can_proceed=true" >> $GITHUB_OUTPUT
      
      - name: ðŸ“Š í˜„ìž¬ í†µê³„ ì¡°íšŒ
        id: stats
        if: steps.check.outputs.can_proceed == 'true'
        run: |
          echo "ðŸ“Š Supabase í†µê³„ ì¡°íšŒ ì¤‘..."
          
          BASE_URL="${{ env.CAFE24_SYNC_URL }}"
          BASE_DIR=$(dirname "$BASE_URL")
          
          STATS_URL="${BASE_DIR}/sync_stats.php?t=${{ env.SYNC_TOKEN }}"
          
          RESPONSE=$(curl -s "$STATS_URL")
          
          echo "ì‘ë‹µ:"
          echo "$RESPONSE" | jq '.'
          
          ERROR=$(echo "$RESPONSE" | jq -r '.error // empty')
          if [ -n "$ERROR" ]; then
            echo "âŒ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨: $ERROR"
            exit 1
          fi
          
          MYSQL_TOTAL=$(echo "$RESPONSE" | jq -r '.mysql_total // 0')
          SUPABASE_SYNCED=$(echo "$RESPONSE" | jq -r '.supabase_synced // 0')
          SYNC_RATE=$(echo "$RESPONSE" | jq -r '.sync_rate // 0')
          REMAINING=$(echo "$RESPONSE" | jq -r '.remaining // 0')
          
          # ðŸ†• ì²« ì‹¤í–‰ ì—¬ë¶€ íŒë‹¨ (Supabaseì— ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì²« ì‹¤í–‰)
          IS_FIRST_RUN="false"
          if [ "$SUPABASE_SYNCED" -eq 0 ] && [ "$MYSQL_TOTAL" -gt 0 ]; then
            IS_FIRST_RUN="true"
            echo "ðŸ†• ì²« ì‹¤í–‰ ê°ì§€: Supabaseì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."
          fi
          
          echo "mysql_total=$MYSQL_TOTAL" >> $GITHUB_OUTPUT
          echo "supabase_synced=$SUPABASE_SYNCED" >> $GITHUB_OUTPUT
          echo "sync_rate=$SYNC_RATE" >> $GITHUB_OUTPUT
          echo "remaining=$REMAINING" >> $GITHUB_OUTPUT
          echo "is_first_run=$IS_FIRST_RUN" >> $GITHUB_OUTPUT
          
          echo "### ðŸ“Š í˜„ìž¬ í†µê³„" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| í•­ëª© | ê°’ |" >> $GITHUB_STEP_SUMMARY
          echo "|------|---:|" >> $GITHUB_STEP_SUMMARY
          echo "| MySQL ì „ì²´ | ${MYSQL_TOTAL}ê±´ |" >> $GITHUB_STEP_SUMMARY
          echo "| Supabase ë™ê¸°í™” | ${SUPABASE_SYNCED}ê±´ |" >> $GITHUB_STEP_SUMMARY
          echo "| **ë™ê¸°í™”ìœ¨** | **${SYNC_RATE}%** |" >> $GITHUB_STEP_SUMMARY
          echo "| ë‚¨ì€ ë°ì´í„° | ${REMAINING}ê±´ |" >> $GITHUB_STEP_SUMMARY
          echo "| **ì²« ì‹¤í–‰** | **${IS_FIRST_RUN}** |" >> $GITHUB_STEP_SUMMARY

  sync:
    name: ðŸ”„ ì›Œì»¤ ${{ matrix.worker_id }}
    runs-on: ubuntu-latest
    needs: preflight
    if: needs.preflight.outputs.can_proceed == 'true' && needs.preflight.outputs.remaining > 0
    timeout-minutes: 480
    
    strategy:
      max-parallel: 2
      matrix:
        worker_id: [0, 1]
    
    steps:
      - name: ðŸš€ ë°˜ë³µ ë°°ì¹˜ ë™ê¸°í™” ì‹¤í–‰
        id: sync_batches
        env:
          BATCH_SIZE: ${{ github.event.inputs.batch_size || '50' }}
          WORKER_ID: ${{ matrix.worker_id }}
          MAX_ITERATIONS: ${{ github.event.inputs.max_iterations || '500' }}
          IS_FIRST_RUN: ${{ needs.preflight.outputs.is_first_run }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸš€ ì›Œì»¤ #${WORKER_ID} ì‹œìž‘"
          echo "  - ë°°ì¹˜ í¬ê¸°: ${BATCH_SIZE}"
          echo "  - ìµœëŒ€ ë°˜ë³µ: ${MAX_ITERATIONS}"
          echo "  - ì²« ì‹¤í–‰: ${IS_FIRST_RUN}"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          BASE_URL="${{ env.CAFE24_SYNC_URL }}"
          SYNC_TOKEN="${{ env.SYNC_TOKEN }}"
          
          # ðŸ†• ì²« ì‹¤í–‰ì´ë©´ skip-synced=0, ì•„ë‹ˆë©´ skip-synced=1
          if [ "$IS_FIRST_RUN" = "true" ]; then
            SKIP_SYNCED=0
            echo "ðŸ“Œ ì²« ì‹¤í–‰: ì¤‘ë³µ ì²´í¬ ë¹„í™œì„±í™” (skip-synced=0)"
          else
            SKIP_SYNCED=1
            echo "ðŸ“Œ ìž¬ì‹¤í–‰: ì¤‘ë³µ ì²´í¬ í™œì„±í™” (skip-synced=1)"
          fi
          
          ITERATION=0
          TOTAL_PROCESSED=0
          OFFSET=$((WORKER_ID * BATCH_SIZE))
          
          while [ $ITERATION -lt $MAX_ITERATIONS ]; do
            ITERATION=$((ITERATION + 1))
            
            echo ""
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo "ðŸ”„ ì›Œì»¤ #${WORKER_ID} - ë°˜ë³µ ${ITERATION}/${MAX_ITERATIONS}"
            echo "  - ì˜¤í”„ì…‹: ${OFFSET}"
            echo "  - ë°°ì¹˜ í¬ê¸°: ${BATCH_SIZE}"
            echo "  - ì¤‘ë³µ ê±´ë„ˆë›°ê¸°: ${SKIP_SYNCED}"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            
            # URL êµ¬ì„±
            if [[ "$BASE_URL" == *"?"* ]]; then
              SYNC_URL="${BASE_URL}&t=${SYNC_TOKEN}&batch=${BATCH_SIZE}&offset=${OFFSET}&skip-synced=${SKIP_SYNCED}"
            else
              SYNC_URL="${BASE_URL}?t=${SYNC_TOKEN}&batch=${BATCH_SIZE}&offset=${OFFSET}&skip-synced=${SKIP_SYNCED}"
            fi
            
            echo "ðŸ”— ìš”ì²­ URL: ${SYNC_URL%\?t=*}?t=***&batch=${BATCH_SIZE}&offset=${OFFSET}&skip-synced=${SKIP_SYNCED}"
            
            # HTTP ìš”ì²­
            RESPONSE=$(curl -s -w "\n%{http_code}" "$SYNC_URL")
            HTTP_CODE=$(echo "$RESPONSE" | tail -n1)
            BODY=$(echo "$RESPONSE" | sed '$d')
            
            echo "ðŸ“Š HTTP ì‘ë‹µ ì½”ë“œ: ${HTTP_CODE}"
            
            if [ "$HTTP_CODE" != "200" ]; then
              echo "âŒ HTTP ì˜¤ë¥˜: ${HTTP_CODE}"
              echo "$BODY" | jq '.' || echo "$BODY"
              echo "â¸ï¸ 5ì´ˆ í›„ ìž¬ì‹œë„..."
              sleep 5
              continue
            fi
            
            # JSON íŒŒì‹±
            echo "$BODY" | jq '.' > /dev/null 2>&1
            if [ $? -ne 0 ]; then
              echo "âš ï¸ JSON íŒŒì‹± ì‹¤íŒ¨, ì›ë³¸ ì‘ë‹µ:"
              echo "$BODY" | head -c 500
              echo "â¸ï¸ 5ì´ˆ í›„ ìž¬ì‹œë„..."
              sleep 5
              continue
            fi
            
            # ê²°ê³¼ í™•ì¸
            OK=$(echo "$BODY" | jq -r '.ok // false')
            PROCESSED=$(echo "$BODY" | jq -r '.batch.processed // 0')
            UPSERTED=$(echo "$BODY" | jq -r '.batch.upserted // 0')
            HAS_MORE=$(echo "$BODY" | jq -r '.config.has_more // false')
            
            echo "âœ… ì²˜ë¦¬ ì™„ë£Œ:"
            echo "  - ì²˜ë¦¬: ${PROCESSED}ê±´"
            echo "  - ì—…ë¡œë“œ: ${UPSERTED}ê±´"
            echo "  - ì¶”ê°€ ë°ì´í„°: ${HAS_MORE}"
            
            TOTAL_PROCESSED=$((TOTAL_PROCESSED + PROCESSED))
            
            # ì¢…ë£Œ ì¡°ê±´
            if [ "$PROCESSED" -eq 0 ] || [ "$HAS_MORE" = "false" ]; then
              echo "ðŸ ë” ì´ìƒ ì²˜ë¦¬í•  ë°ì´í„° ì—†ìŒ"
              break
            fi
            
            # ë‹¤ìŒ ì˜¤í”„ì…‹ ê³„ì‚° (ì›Œì»¤ ìˆ˜ë§Œí¼ ì¦ê°€)
            OFFSET=$((OFFSET + BATCH_SIZE * 2))
            
            # ëŒ€ê¸° ì‹œê°„ (API ë¶€í•˜ ë¶„ì‚°)
            sleep 3
          done
          
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "âœ… ì›Œì»¤ #${WORKER_ID} ì™„ë£Œ"
          echo "  - ì´ ë°˜ë³µ: ${ITERATION}íšŒ"
          echo "  - ì´ ì²˜ë¦¬: ${TOTAL_PROCESSED}ê±´"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

  # âš¡ ì‹ ê·œ: ìž¬ë™ê¸°í™” ìžë™ ì‹¤í–‰
  auto_resync:
    name: ðŸ”„ ìžë™ ìž¬ë™ê¸°í™”
    runs-on: ubuntu-latest
    needs: [preflight, sync]
    if: always() && needs.preflight.outputs.can_proceed == 'true'
    
    steps:
      - name: ðŸ“Š ë™ê¸°í™” í›„ í†µê³„ í™•ì¸
        id: check_remaining
        run: |
          echo "ðŸ“Š ìµœì¢… í†µê³„ ì¡°íšŒ ì¤‘..."
          
          BASE_URL="${{ env.CAFE24_SYNC_URL }}"
          BASE_DIR=$(dirname "$BASE_URL")
          
          STATS_URL="${BASE_DIR}/sync_stats.php?t=${{ env.SYNC_TOKEN }}"
          
          RESPONSE=$(curl -s "$STATS_URL")
          
          REMAINING=$(echo "$RESPONSE" | jq -r '.remaining // 0')
          SYNC_RATE=$(echo "$RESPONSE" | jq -r '.sync_rate // 0')
          
          echo "remaining=$REMAINING" >> $GITHUB_OUTPUT
          echo "sync_rate=$SYNC_RATE" >> $GITHUB_OUTPUT
          
          echo "### ðŸ“Š ë™ê¸°í™” í›„ í†µê³„" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- ë‚¨ì€ ë°ì´í„°: ${REMAINING}ê±´" >> $GITHUB_STEP_SUMMARY
          echo "- ë™ê¸°í™”ìœ¨: ${SYNC_RATE}%" >> $GITHUB_STEP_SUMMARY
      
      - name: ðŸ”„ ìžë™ ìž¬ë™ê¸°í™” ì‹¤í–‰
        if: steps.check_remaining.outputs.remaining > 0 && steps.check_remaining.outputs.remaining <= 500
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ”„ ìžë™ ìž¬ë™ê¸°í™” ì‹œìž‘"
          echo "  - ë‚¨ì€ ë°ì´í„°: ${{ steps.check_remaining.outputs.remaining }}ê±´"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          BASE_URL="${{ env.CAFE24_SYNC_URL }}"
          BASE_DIR=$(dirname "$BASE_URL")
          
          RESYNC_URL="${BASE_DIR}/sync_stats.php?t=${{ env.SYNC_TOKEN }}&action=auto_resync"
          
          RESPONSE=$(curl -s "$RESYNC_URL")
          
          echo "ì‘ë‹µ:"
          echo "$RESPONSE" | jq '.'

  finalize:
    name: ðŸ“Š ìµœì¢… í†µê³„
    runs-on: ubuntu-latest
    needs: [preflight, sync, auto_resync]
    if: always() && needs.preflight.outputs.can_proceed == 'true'
    
    steps:
      - name: ðŸ“Š ìµœì¢… í†µê³„ ì¡°íšŒ
        run: |
          echo "ðŸ“Š ìµœì¢… Supabase í†µê³„ ì¡°íšŒ ì¤‘..."
          
          BASE_URL="${{ env.CAFE24_SYNC_URL }}"
          BASE_DIR=$(dirname "$BASE_URL")
          
          STATS_URL="${BASE_DIR}/sync_stats.php?t=${{ env.SYNC_TOKEN }}"
          
          sleep 30
          
          RESPONSE=$(curl -s "$STATS_URL")
          
          echo "ì‘ë‹µ:"
          echo "$RESPONSE" | jq '.'
          
          MYSQL_TOTAL=$(echo "$RESPONSE" | jq -r '.mysql_total // 0')
          SUPABASE_SYNCED=$(echo "$RESPONSE" | jq -r '.supabase_synced // 0')
          SYNC_RATE=$(echo "$RESPONSE" | jq -r '.sync_rate // 0')
          REMAINING=$(echo "$RESPONSE" | jq -r '.remaining // 0')
          
          echo "### ðŸŒ ì „ì²´ ë™ê¸°í™” í˜„í™©" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| í•­ëª© | ê°’ |" >> $GITHUB_STEP_SUMMARY
          echo "|------|---:|" >> $GITHUB_STEP_SUMMARY
          echo "| MySQL ì „ì²´ ë ˆì½”ë“œ | ${MYSQL_TOTAL}ê±´ |" >> $GITHUB_STEP_SUMMARY
          echo "| Supabase ë™ê¸°í™” ì™„ë£Œ | ${SUPABASE_SYNCED}ê±´ |" >> $GITHUB_STEP_SUMMARY
          echo "| **ë™ê¸°í™”ìœ¨** | **${SYNC_RATE}%** |" >> $GITHUB_STEP_SUMMARY
          echo "| ë‚¨ì€ ë°ì´í„° | ${REMAINING}ê±´ |" >> $GITHUB_STEP_SUMMARY
          echo "- **ì›Œì»¤ ìˆ˜**: ${{ github.event.inputs.workers || '2' }}ê°œ" >> $GITHUB_STEP_SUMMARY
          echo "- **ë°°ì¹˜ í¬ê¸°**: ${{ github.event.inputs.batch_size || '50' }}ê±´" >> $GITHUB_STEP_SUMMARY
          echo "- **ìµœëŒ€ ë°˜ë³µ**: ${{ github.event.inputs.max_iterations || '500' }}íšŒ" >> $GITHUB_STEP_SUMMARY
          echo "- **ì™„ë£Œ ì‹œê°„**: $(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          if [ "$REMAINING" -eq 0 ]; then
            echo "## âœ… ë™ê¸°í™” ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "ëª¨ë“  ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤! ðŸŽ‰" >> $GITHUB_STEP_SUMMARY
          else
            echo "## ðŸ”„ ë™ê¸°í™” ì§„í–‰ ì¤‘" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "ë‹¤ìŒ ìŠ¤ì¼€ì¤„ì—ì„œ ê³„ì† ì§„í–‰ë©ë‹ˆë‹¤." >> $GITHUB_STEP_SUMMARY
          fi
      
      - name: ðŸ“‹ ì‹¤í–‰ ì •ë³´
        run: |
          echo "### ðŸ“‹ ì‹¤í–‰ ì •ë³´" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- **ì›Œì»¤ ìˆ˜**: ${{ github.event.inputs.workers || '2' }}ê°œ" >> $GITHUB_STEP_SUMMARY
          echo "- **ë°°ì¹˜ í¬ê¸°**: ${{ github.event.inputs.batch_size || '50' }}ê±´" >> $GITHUB_STEP_SUMMARY
          echo "- **ìµœëŒ€ ë°˜ë³µ**: ${{ github.event.inputs.max_iterations || '500' }}íšŒ" >> $GITHUB_STEP_SUMMARY
          echo "- **ìžë™ ìž¬ë™ê¸°í™”**: í™œì„±í™” (ìž„ê³„ê°’: 500ê±´)" >> $GITHUB_STEP_SUMMARY
          echo "- **ì™„ë£Œ ì‹œê°„**: $(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> $GITHUB_STEP_SUMMARY

          
          
